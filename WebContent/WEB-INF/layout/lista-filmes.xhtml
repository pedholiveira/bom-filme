<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui">

	<h:form>
		<p:panelGrid id="panel-filme" columns="2">
			<p:outputLabel for="nome" value="Nome: " />
			<p:inputText id="nome" value="#{filmeBean.filtro.nome}"/>
			
			<p:outputLabel for="nomeOriginal" value="Nome original: " />
			<p:inputText id="nomeOriginal" value="#{filmeBean.filtro.nomeOriginal}" />
			
			<p:outputLabel for="nomeDiretor" value="Nome do Diretor: " />
			<p:inputText id="nomeDiretor" value="#{filmeBean.filtro.nomeDiretor}" />
			
			<p:outputLabel for="nomeAtor" value="Ator: " />
			<p:selectOneMenu id="nomeAtor" value="#{filmeBean.filtro.nomeAtor}" effect="fold">
				<f:selectItem></f:selectItem>
		            <f:selectItems value="#{filmeBean.lerAtores()}" var="ator" itemLabel="#{ator.nome}" itemValue="#{ator.nome}" />
	        </p:selectOneMenu>
											
			<p:commandButton value="Pesquisar" action="#{filmeBean.pesquisar}" update="table-filmes"/>		
		</p:panelGrid>
	</h:form>
	
	<ui:include src="lista-carrinho.xhtml" />

	<p:dataTable id="table-filmes" var="filme" value="#{filmeBean.filmes}">
		<f:facet name="header">
            Acervo de Filmes
        </f:facet>
		<p:column headerText="Nome: " sortBy="#{filme.nome}">
	        <h:outputText value="#{filme.nome}" />
	    </p:column>
		<p:column headerText="Nome original: " sortBy="#{filme.nomeOriginal}">
	        <h:outputText value="#{filme.nomeOriginal}" />
	    </p:column>
	    <p:column headerText="Estúdio: " sortBy="#{filme.estudioPrincipal}">
	        <h:outputText value="#{filme.estudioPrincipal}" />
	    </p:column>
	    <p:column headerText="Ano de Produção: " sortBy="#{filme.anoProducao}">
	        <h:outputText value="#{filme.anoProducao}" />
	    </p:column>
	    <p:column headerText="Quantidade disponível: ">
	    	<h:form>
		    	<p:panelGrid columns="1">
		    		<p:row>
		    			<p:outputLabel value="DVD - #{filmeBean.lerQuantidadeExemplares(filme, 'DVD')}" style="float: left" />
		    			<p:commandLink value="Incluir no carrinho" style="float: right">
		    				<p:ajax event="click" update="@all" listener="#{carrinhoBean.incluirItemCarrinho(filme, 'DVD')}"/>
		    			</p:commandLink>
		    		</p:row>
		    		<p:row>
		    			<p:outputLabel value="Bluray - #{filmeBean.lerQuantidadeExemplares(filme, 'Bluray')}" style="float: left"/>
			    		<p:commandLink value="Incluir no carrinho" style="float: right">
			    			<p:ajax event="click" update="@all" listener="#{carrinhoBean.incluirItemCarrinho(filme, 'Bluray')}"/>
			    		</p:commandLink>
		    		</p:row>
		    	</p:panelGrid>
		    </h:form>
	    </p:column>
	</p:dataTable>
</ui:composition>
